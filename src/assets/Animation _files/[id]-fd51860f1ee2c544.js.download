(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2142,2861,6332,5491],{97015:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]",function(){return n(91414)}])},77221:function(e,t,n){"use strict";n.d(t,{o:function(){return l}});var o=n(97458);const l=n(52983).forwardRef(((e,t)=>{let{children:n,contentWrapperCssClasses:l="flex-grow overflow-hidden",headerControl:s,headerWrapperCssClasses:r="bg-white h-16 flex items-center sm:px-6 px-2 border-b border-gray-100 flex-shrink-0",id:i}=e;return(0,o.jsxs)("div",{id:i,ref:t,"data-onboarding-watch":"create_menu_new_button",className:"flex overflow-y-auto absolute inset-0 flex-col w-full",children:[s&&(0,o.jsx)("div",{className:r,children:s}),(0,o.jsx)("div",{className:l,children:n})]})}));l.displayName="PageScaffold"},36522:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});var o=n(52983),l=n(46736);const s=e=>{let{scopes:t}=e;const n=(0,o.useCallback)((()=>Boolean(null==t?void 0:t.includes(l.l.DOWNLOAD))),[t]);return{hasUpdateAccess:(0,o.useCallback)((()=>Boolean(null==t?void 0:t.includes(l.l.FULL_ACCESS))),[t]),hasDownloadAccess:n}}},38299:function(e,t,n){"use strict";var o=n(52983);t.Z=e=>{let{onPress:t,onRelease:n,dependencies:l=[],takesPrecedence:s}=e;(0,o.useEffect)((()=>{const e=e=>{const n=document.activeElement;n&&n.isContentEditable||n&&"button"===n.tagName.toLowerCase()&&!s||"Shift"===e.key&&(e.preventDefault(),t())},o=e=>{const t=document.activeElement;t&&t.isContentEditable||t&&"button"===t.tagName.toLowerCase()&&!s||"Shift"===e.key&&(e.preventDefault(),n())};return window.addEventListener("keydown",e),window.addEventListener("keyup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keydown",o)}}),l)}},91414:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var o=n(97458),l=n(14854),s=n(40586),r=n(8e3),i=n.n(r),a=n(29130),c=n.n(a),d=n(52983),u=n(75800),f=n(80794),p=n(77221),v=n(74699),h=n(12077),w=n(82929),m=n(36522),g=n(38299),y=n(84650),k=n(59114),C=n(19877);var E=n(99509),S=n(58843),x=n(37325),b=n(12940),j=n(46850),I=n(34382),R=n(773),A=n(2063),D=n(42721),L=n(83849),N=n.n(L),P=n(64342),F=n(55417);const T=i()((async()=>Promise.all([n.e(299),n.e(4247),n.e(4688),n.e(7019)]).then(n.bind(n,50070))),{loadableGenerated:{webpack:()=>[50070]},ssr:!1}),_=i()((async()=>Promise.all([n.e(6673),n.e(4998),n.e(5154)]).then(n.bind(n,15459))),{loadableGenerated:{webpack:()=>[15459]},ssr:!1}),O=i()((async()=>Promise.all([n.e(7299),n.e(2274)]).then(n.bind(n,62274))),{loadableGenerated:{webpack:()=>[62274]},ssr:!1});function G(){const e=(0,s.useRouter)(),{user:t}=(0,h.a)(),{from:n,id:r,sort:i,status:a,type:L}=e.query,G=(0,v.p)(),B=(0,u.useSetRecoilState)(j.qx),M=(0,u.useSetRecoilState)(I.QJ),[W,U]=(0,d.useState)([]),q=(0,u.useSetRecoilState)(x.Y),J=W.length>0,[V,Y]=(0,d.useState)(null),[Z,Q]=(0,d.useState)(!1),[H,X]=(0,d.useState)(null),[K,z]=(0,d.useState)(null),[$,ee]=(0,d.useState)(!1),{downloadAllInFolder:te,downloadAllInProject:ne,downloadSelection:oe,isZipDownloadInProgress:le}=(0,D.p)();(0,g.Z)({onPress:()=>{Q(!0)},onRelease:()=>{Q(!1)}});const{handleLoadMore:se,hasNextPage:re,isFetchingMore:ie,isLoading:ae,project:ce,projectFiles:de,totalCount:ue}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,o,l,s,r,i;const a=(0,y.useRouter)(),{user:c}=(0,h.a)(),{type:u}=a.query,[p,v]=(0,d.useState)(!1),[w]=(0,f.aM)({query:k.FE,variables:{id:e},pause:!e}),m=(null===(n=w.data)||void 0===n?void 0:n.project)||null,g="folders"!==u&&(null==m?void 0:m.isSystem)&&"Drafts"===(null==m?void 0:m.title),[E]=(0,f.aM)({query:k.f3,variables:{id:e,orderBy:t.orderBy||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),status:t.status,type:t.type,first:t.first||24,...g&&{createdByUserId:null==c?void 0:c.id}},pause:!e||!(null==c?void 0:c.id)||!m}),S=null===(l=E.data)||void 0===l||null===(o=l.projectFiles)||void 0===o?void 0:o.edges.map((e=>e.node)),x=(null===(s=E.data)||void 0===s?void 0:s.projectFiles.pageInfo.endCursor)||null,b=(null===(r=E.data)||void 0===r?void 0:r.projectFiles.pageInfo.hasNextPage)||!1,j=(0,f.m8)(),I=(0,d.useCallback)((async function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var o;if(!S||0===(null==S?void 0:S.length))return;const l=n&&E.data?(null===(o=E.data)||void 0===o?void 0:o.projectFiles.totalCount)-(null==S?void 0:S.length):24;try{v(!0),await j.query(k.f3,{id:e,status:t.status,type:t.type,orderBy:t.orderBy||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),after:x,first:l,...g&&{createdByUserId:null==c?void 0:c.id}}).toPromise()}finally{v(!1)}}),[S,E.data,j,e,t.status,t.type,t.orderBy,x,g,null==c?void 0:c.id]),R=(0,d.useCallback)((()=>{w.data&&!w.fetching&&!p&&b&&x&&I()}),[x,I,w.data,w.fetching,b,p]);return(0,d.useEffect)((()=>{w.error&&(0,C.w)(w.error)}),[w.error]),{project:m,projectFiles:S,isLoading:w.fetching||E.fetching,isFetchingMore:p,hasNextPage:b,totalCount:(null===(i=E.data)||void 0===i?void 0:i.projectFiles.totalCount)||0,handleLoadMore:R,fetchNextPage:I}}(r,{first:24,orderBy:i,status:a,type:L}),fe=(0,S.hp)(null==ce?void 0:ce.workspaceId),{activeWorkspaceId:pe,isSwitchingWorkspace:ve,setActiveWorkspace:he,workspaces:we}=(0,P.c)();(0,d.useEffect)((()=>{ce&&(M({name:ce.title,isPrivate:Boolean(ce.isPrivate),isSystem:ce.isSystem,projectTitle:ce.title,type:"project",workspaceId:ce.workspaceId,projectId:ce.id}),(0,l.Z9)(new l.RG({projectId:ce.id,projectName:ce.title,workspaceId:ce.workspaceId,url:window.location.href})),B(!1))}),[ce,B,M]);const me=(0,d.useCallback)((e=>{X(A.RT.LOADED);const t=W,n=t.map((e=>e.id)).indexOf(e);if(de){const o=de.find((t=>t.id===e));if(!o)return;const l=de.indexOf(o);if(Z)if(null===V)t.push(o);else{const e=(0,A.Jm)(V,l,de);n>-1?(0,A.wh)(t,e):(0,A.AW)(t,e)}else n>-1?t.splice(n,1):t.push(o);Y(l)}0===t.length&&X(null),U([...t]),q(t.length)}),[W,de,q,V,Z]),ge=(0,d.useCallback)((()=>{X(null),q(0),U([]),Y(null),ee(!1)}),[q]);(0,d.useEffect)((()=>{le&&ge()}),[le,ge]);const ye=(0,d.useCallback)((()=>{if(ce)try{oe({project:ce,downloadAssetCount:H===A.RT.EVERYTHING?ue:W.length,entries:H===A.RT.EVERYTHING?[{id:r,type:"PROJECT"}]:W.map((e=>({id:e.id,type:(0,R.qR)(e)?"FOLDER":"FILE"})))})}catch(e){null==G||G.pushError(e.message)}}),[oe,ce,ue,W,H,G,r]),ke=(0,d.useCallback)((()=>{if(ce)try{ne({project:ce,downloadAssetCount:ue})}catch(e){null==G||G.pushError(e.message)}}),[ne,ce,ue,G]),Ce=(0,d.useCallback)(((e,t)=>{if(ce)try{te({downloadAssetCount:1,folderId:e,folderName:t,project:ce})}catch(e){null==G||G.pushError(e.message)}}),[te,ce,G]),[Ee,Se]=(0,w._)(F.dR.PROJECT_LAYOUT,F.o6.GRID),xe=(0,d.useCallback)((()=>{Ee===F.o6.GRID?Se(F.o6.LIST):Se(F.o6.GRID),(0,l.Z9)(new l.rR({projectId:r,userId:null==t?void 0:t.id,view:Ee===F.o6.GRID?F.o6.LIST:F.o6.GRID}))}),[Ee,Se,r,t]),be=(0,u.useRecoilValue)(b.h),je=(0,d.useCallback)((()=>{ge(),null==G||G.pushSuccess("".concat(W.length>1?"Assets were":"Asset was"," successfully transferred to ").concat(null==be?void 0:be.name,"."))}),[ge,W.length,null==be?void 0:be.name,G]),Ie=(0,d.useCallback)((e=>{const t=W;e?((0,A.AW)(t,de||[]),q(t.length),X(A.RT.LOADED),ee(!0)):((0,A.wh)(t,de||[]),q(t.length),X(null),ee(!1)),U([...t])}),[de,W,q]);(0,d.useEffect)((()=>{ge()}),[e.asPath,ge]);const Re="https://creator.lottiefiles.com",Ae=(0,d.useCallback)(((t,o)=>{let l;const s="shared-with-me"===n;if(((0,R.QR)(t)||(0,R.xK)(t))&&(l=t.fileObject.filename.split(".").pop()),"creator"===l)window.open("".concat(Re,"?fileId=").concat(t.id,"&utm_medium=platform&utm_source=file-card"),"_blank");else{let n;n=(0,R.qR)(t)?"/folder/".concat(t.id):"/animation/".concat(t.id),i&&(n+="?sort=".concat(encodeURIComponent(i.toString()))),s&&(n+="".concat(i?"&":"?","from=shared-with-me")),o?window.open(n,"_blank"):e.push(n)}}),[n,Re,i,e]),De=(0,f.m8)(),Le=(0,d.useCallback)((async()=>{if(de){const e=await De.query(k.A0,{id:r}).toPromise();e.data&&z(e.data.project.stats),U([...de])}X(A.RT.EVERYTHING)}),[De,r,de]),Ne=W.length&&(null==de?void 0:de.some((e=>-1===W.findIndex((t=>t.id===e.id)))))||!1,{hasDownloadAccess:Pe,hasUpdateAccess:Fe}=(0,m.O)({scopes:(null==ce?void 0:ce.projectPermissionScopes)||[]}),[Te,_e]=(0,d.useState)(!1);return(0,d.useEffect)((()=>{"folders"!==L&&(null==ce?void 0:ce.isSystem)&&"Drafts"===(null==ce?void 0:ce.title)&&(null==t?void 0:t.id)&&!Te&&((0,l.Z9)(new l.di({userId:t.id})),_e(!0))}),[L,ce,null==t?void 0:t.id,Te]),(0,d.useEffect)((()=>{if(!fe||!pe||0===we.length)return;if("shared-with-me"===n)return;if(ve)return;(null==fe?void 0:fe.id)!==pe&&we.find((e=>e.id===fe.id))&&he(fe.id,!1)}),[pe,n,ve,he,fe,we]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c(),{children:(0,o.jsx)("title",{children:"Project - LottieFiles Platform"})}),(0,o.jsx)(E.s,{features:null==ce?void 0:ce.features,children:(0,o.jsx)(p.o,{headerWrapperCssClasses:N()("flex items-center px-6 flex-shrink-0 pt-3 pb-4"),contentWrapperCssClasses:"flex-grow p-6 pt-0",headerControl:(0,o.jsx)(T,{selectedCount:W.length,loadedCount:(null==de?void 0:de.length)||0,showFilters:0!==(null==de?void 0:de.length)||(Boolean(a)||Boolean(L)),totalCount:ue,onSelectAll:Ie,selectionIsIndeterminate:Ne,isSelectionMode:J,toggleProjectView:xe,projectView:Ee,project:ce,fromSharedWithMe:"shared-with-me"===n,selectionType:H,onSelectEverything:Le,clearSelection:ge,showSelectionBanner:$,onDownloadAllClick:ke,showSelectAll:Pe()||Fe()}),children:(0,o.jsx)("div",{className:"h-full space-y-3",children:ce&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(O,{files:de,hasNextPage:re,isFetchingFiles:ae,isFetchingMore:ie,isSelectionMode:J,onFolderDownloadAllClick:Ce,onItemClick:Ae,onLoadMore:se,onSelectionChange:me,project:ce,selectedFiles:W,status:a,type:L,view:Ee}),J?(0,o.jsx)(_,{canDelete:Fe(),canDownload:Pe(),canMove:Fe(),canUpdateStatus:Fe(),canAddToCollection:Fe(),type:"project",resourceId:ce.id,workspaceId:ce.workspace.id,selectedAnimations:W,isPrivate:ce.isPrivate,clear:ge,onDownload:ye,onTransferComplete:je,totalCount:ue,contentStats:K,isEverythingSelected:H===A.RT.EVERYTHING}):null]})})})})]})}},99509:function(e,t,n){"use strict";n.d(t,{s:function(){return i},w:function(){return a}});var o=n(97458),l=n(78463),s=n(52983);const r=s.createContext({features:[]}),i=e=>{let{children:t,features:n}=e;return(0,o.jsx)(r.Provider,{value:{features:n},children:t})},a=()=>{const{features:e}=s.useContext(r);return e?new l.UZ(e):new l.UZ([])}},37325:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});const o=(0,n(75800).atom)({key:"selectedAnimationsCount",default:0})},14326:function(e,t,n){"use strict";n.d(t,{h:function(){return l}});var o=n(75800);const l=(0,o.atom)({key:"transferSelectionAtom",default:null});(0,o.atom)({key:"createNewFolder",default:!1})},12940:function(e,t,n){"use strict";n.d(t,{h:function(){return o.h}});var o=n(14326)},46736:function(e,t,n){"use strict";var o;function l(e){return"object"==typeof e&&null!==e&&"folders"in e}n.d(t,{k:function(){return l},l:function(){return o}}),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.VIEW="view"}(o||(o={}))},19877:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var o=n(92520),l=n(74035);const s={"Access denied!":e=>{var t,n,l,s;const r=null!==(s=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==s?s:"";var i;const a=null!==(i=null==e||null===(l=e.extensions)||void 0===l||null===(n=l.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==i?i:[];throw console.log("Error code:",r),console.log("Stacktrace:",a),new o.J},"Database query failed":e=>{var t,n,l,s;const r=null!==(s=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==s?s:"";var i;const a=null!==(i=null==e||null===(l=e.extensions)||void 0===l||null===(n=l.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==i?i:[];throw console.log("Error code:",r),console.log("Stacktrace:",a),new o.J},"File not found":e=>{var t,n,o,s;const r=null!==(s=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==s?s:"";var i;const a=null!==(i=null==e||null===(o=e.extensions)||void 0===o||null===(n=o.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==i?i:[];throw console.log("Error code:",r),console.log("Stacktrace:",a),new l.T},Forbidden:e=>{var t,n,l,s;const r=null!==(s=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==s?s:"";var i;const a=null!==(i=null==e||null===(l=e.extensions)||void 0===l||null===(n=l.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==i?i:[];throw console.log("Error code:",r),console.log("Stacktrace:",a),new o.J}};function r(e){e.networkError?console.error("Network error:",e.networkError):e.graphQLErrors&&e.graphQLErrors.length>0?e.graphQLErrors.forEach((e=>{const t=e.message,n=Object.keys(s).find((e=>t.includes(e)));var o;n?null===(o=s[n])||void 0===o||o.call(s,e):console.error("GraphQL error:",e)})):console.error("Unknown error:",e)}},2063:function(e,t,n){"use strict";var o;function l(e,t,n){const o=Math.min(e,t),l=Math.max(e+1,t+1);return n.splice(o,l-o)}function s(e,t){t.forEach((t=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&e.splice(n,1)}))}function r(e,t){t.forEach((t=>{-1===e.findIndex((e=>e.id===t.id))&&e.push(t)}))}n.d(t,{AW:function(){return r},Jm:function(){return l},RT:function(){return o},wh:function(){return s}}),function(e){e.EVERYTHING="everything",e.LOADED="loaded"}(o||(o={}))}},function(e){e.O(0,[2888,9774,179],(function(){return t=97015,e(e.s=t);var t}));var t=e.O();_N_E=t}]);